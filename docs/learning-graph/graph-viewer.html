<!DOCTYPE html>
<html>
<head>
    <title>Learning Graph: Political Canvassing and Door Knocking</title>
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { margin: 0; padding: 0; font-family: Arial, sans-serif; background: AliceBlue; }
        #header { padding: 10px 20px; background: #2c3e50; color: white; display: flex; justify-content: space-between; align-items: center; }
        #header h1 { margin: 0; font-size: 18px; }
        #network { width: 100%; height: calc(100vh - 90px); }
        #legend { padding: 8px 20px; background: #ecf0f1; display: flex; flex-wrap: wrap; gap: 12px; align-items: center; font-size: 13px; }
        .legend-item { display: flex; align-items: center; gap: 4px; }
        .legend-color { width: 14px; height: 14px; border-radius: 3px; border: 1px solid #999; }
        #stats { font-size: 13px; color: #bdc3c7; }
    </style>
</head>
<body>
    <div id="header">
        <h1>Learning Graph: How to Volunteer for Political Canvassing and Door Knocking</h1>
        <div id="stats"></div>
    </div>
    <div id="legend"></div>
    <div id="network"></div>
    <script>
        fetch('learning-graph.json')
            .then(r => r.json())
            .then(data => {
                const stats = document.getElementById('stats');
                stats.textContent = `${data.nodes.length} concepts | ${data.edges.length} edges | ${Object.keys(data.groups).length} categories`;

                const legend = document.getElementById('legend');
                for (const [id, group] of Object.entries(data.groups)) {
                    const item = document.createElement('span');
                    item.className = 'legend-item';
                    item.innerHTML = `<span class="legend-color" style="background:${group.color}"></span>${group.classifierName}`;
                    legend.appendChild(item);
                }

                const nodes = new vis.DataSet(data.nodes.map(n => ({
                    id: n.id,
                    label: n.label,
                    group: n.group,
                    shape: n.shape || 'dot',
                    font: { size: 11, face: 'Arial' },
                    size: n.shape === 'box' ? undefined : 8
                })));

                const edges = new vis.DataSet(data.edges.map(e => ({
                    from: e.from,
                    to: e.to,
                    arrows: { to: { enabled: true, scaleFactor: 0.5 } },
                    color: { color: '#999', opacity: 0.6 },
                    width: 0.5
                })));

                const groups = {};
                for (const [id, group] of Object.entries(data.groups)) {
                    groups[id] = {
                        color: { background: group.color, border: '#888' },
                        font: { color: group.font?.color || 'black' }
                    };
                }

                const container = document.getElementById('network');
                const network = new vis.Network(container, { nodes, edges }, {
                    groups: groups,
                    layout: {
                        hierarchical: {
                            enabled: true,
                            direction: 'LR',
                            sortMethod: 'directed',
                            levelSeparation: 180,
                            nodeSpacing: 20,
                            treeSpacing: 40
                        }
                    },
                    physics: { enabled: false },
                    interaction: {
                        hover: true,
                        tooltipDelay: 100,
                        zoomView: true,
                        dragView: true
                    },
                    edges: { smooth: { type: 'cubicBezier', forceDirection: 'horizontal' } }
                });
            });
    </script>
</body>
</html>
